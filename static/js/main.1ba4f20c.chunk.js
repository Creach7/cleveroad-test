(this["webpackJsonpcleveroad-test"]=this["webpackJsonpcleveroad-test"]||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){},56:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var c=n(10),a=n.n(c),r=n(28),o=n.n(r),i=(n(44),n(45),n(19)),u=function(e){return{type:"PAGE_CHANGED",payload:e}},s=n(0),d=n.n(s),p=n(17),l=n(1),j=n(37),b=n(21),h=n(27),f=n(23);Object(j.a)({apiKey:"AIzaSyAskY_IqIUIDUanOeYz__CvNEykXTwGlZw",authDomain:"cleveroad-test-1c158.firebaseapp.com",projectId:"cleveroad-test-1c158",storageBucket:"cleveroad-test-1c158.appspot.com",messagingSenderId:"298455748492",appId:"1:298455748492:web:978e72811e4165be4310a9",measurementId:"G-3B1QRQQLVZ"});var g=Object(b.f)();function O(){return(O=Object(l.a)(d.a.mark((function e(t){var n,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.e)(Object(b.b)(g,"products"));case 2:n=e.sent,c=[],n.forEach((function(e){c.push(Object(p.a)(Object(p.a)({},e.data()),{},{id:e.id}))})),t(c);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t,n){var c=Object(f.c)(),a=Object(f.d)(c,"".concat(e,"/image.").concat(t.name.split(".").pop())),r=Object(f.e)(a,t);r.on("state_changed",(function(e){var t=e.bytesTransferred/e.totalBytes*100;switch(console.log("Upload is "+t+"% done"),e.state){case"paused":console.log("Upload is paused");break;case"running":console.log("Upload is running")}}),(function(e){e.code}),(function(){Object(f.b)(r.snapshot.ref).then((function(e){console.log("File available at",e),n(e)}))}))}function v(e,t){var n=Object(f.c)(),c=Object(f.d)(n,"".concat(e,"/image.").concat(t));Object(f.a)(c).then((function(){})).catch((function(e){}))}function x(e,t){return _.apply(this,arguments)}function _(){return(_=Object(l.a)(d.a.mark((function e(t,n){var c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=Object(b.d)(g,"products",t),e.next=3,Object(b.g)(c,n);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=Object(l.a)(d.a.mark((function e(t,n){var c,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c=t.photo,t.photo="",e.next=5,Object(b.a)(Object(b.b)(g,"products"),t);case 5:a=e.sent,console.log("Document written with ID: ",a.id),m(a.id,c,(function(e){console.log(e),x(a.id,{photo:e})})),n(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.error("Error adding document: ",e.t0),alert("addProduct Error");case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))).apply(this,arguments)}function w(){return(w=Object(l.a)(d.a.mark((function e(t,n){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(b.c)(Object(b.d)(g,"products",t));case 2:v(t,n);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=n(7);var C={pageChanged:u},P=Object(i.b)((function(e){return{user:e.user}}),C)((function(e){var t=e.user,n=e.pageChanged,c=a.a.createRef();return Object(D.jsxs)("div",{className:"add-product__page",children:[Object(D.jsx)("button",{className:"add-product__close_button",onClick:function(){return n("ProductsList")},children:"\u2716"}),Object(D.jsxs)("form",{className:"add-product__container",onSubmit:function(e){e.preventDefault(),function(e,t){y.apply(this,arguments)}({heading:e.target[0].value,photo:e.target[1].files[0],description:e.target[2].value,price:e.target[3].value,discount_percent:e.target[4].value,discount_end_date:e.target[5].value,user_id:t.uid},(function(){n("ProductsList")}))},children:[Object(D.jsx)("p",{children:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a"}),Object(D.jsx)("input",{name:"heading",type:"text",required:!0,minLength:"20",maxLength:"40"}),Object(D.jsx)("p",{children:"\u0424\u043e\u0442\u043e"}),Object(D.jsx)("input",{name:"photo",type:"file",alt:"image",required:!0,accept:"image/*",onChange:function(e){var t=function(e){return e>=200&&e<=4e3},n=new FileReader;n.onload=function(){var c=new Image;c.onload=function(){t(c.width)&&t(c.height)||(alert("\u0428\u0438\u0440\u0438\u043d\u0430 \u0438 \u0432\u044b\u0441\u043e\u0442\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 200 \u0438 \u043c\u0435\u043d\u044c\u0448\u0435 4000"),e.target.value="")},c.src=n.result},n.readAsDataURL(e.target.files[0])}}),Object(D.jsx)("p",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),Object(D.jsx)("textarea",{name:"description",type:"text",maxLength:"200"}),Object(D.jsx)("p",{children:"\u0426\u0435\u043d\u0430"}),Object(D.jsx)("input",{name:"price",type:"number",required:!0,step:"0.01",min:"0",max:"99999999.99"}),Object(D.jsx)("p",{children:"\u0421\u043a\u0438\u0434\u043a\u0430"}),Object(D.jsx)("input",{name:"discount-percent",type:"number",min:"10",max:"90",onChange:function(e){""!==e.target.value!==c.current.required&&(c.current.required=""!==e.target.value)}}),Object(D.jsx)("p",{children:"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0441\u043a\u0438\u0434\u043a\u0438"}),Object(D.jsx)("input",{name:"discount-end-date",type:"date",min:function(){var e=new Date;e.setDate(e.getDate()+1);var t=function(e){return e<10?"0".concat(e):e};return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()))}(),ref:c}),Object(D.jsx)("button",{children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442"})]})]})}));n(53);var N={userUpdate:function(e){return{type:"USER_UPDATE",payload:e}},pageChanged:u},E=Object(i.b)((function(){return{}}),N)((function(e){var t=e.userUpdate,n=e.pageChanged;return Object(D.jsx)("div",{className:"authorization__page",children:Object(D.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.dir(e);var c=function(e){t(e),n("ProductsList")};switch(e.nativeEvent.submitter.name){case"signIn":!function(e,t,n,c){var a=Object(h.b)();Object(h.c)(a,e,t).then((function(e){var t=e.user;console.dir(a),n(t)})).catch((function(e){var t=e.code,n=e.message;console.log(t,n),c()}))}(e.target[0].value,e.target[1].value,c,(function(){alert("\u041d\u0435\u043f\u0440\u0430\u0432\u0435\u043b\u044c\u043d\u044b\u0439 email \u0438\u043b\u0438 \u043f\u0430\u0440\u043e\u043b\u044c")}));break;case"create":!function(e,t,n,c){var a=Object(h.b)();Object(h.a)(a,e,t).then((function(e){var t=e.user;n(t)})).catch((function(e){var t=e.code,n=e.message;console.log(t,n),c()}))}(e.target[0].value,e.target[1].value,c,(function(){alert("\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438")}))}},children:[Object(D.jsx)("p",{children:"Email"}),Object(D.jsx)("input",{name:"email",type:"email",required:!0}),Object(D.jsx)("p",{children:"Password"}),Object(D.jsx)("input",{name:"password",type:"password",required:!0}),Object(D.jsx)("button",{name:"signIn",children:"\u0412\u043e\u0439\u0442\u0438"}),Object(D.jsx)("button",{name:"create",children:"\u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u0441\u044f"})]})})}));n(54);var I={pageChanged:u},U=Object(i.b)((function(e){return{productInfo:e.productInfo}}),I)((function(e){var t=e.productInfo,n=e.pageChanged,c=t.id,r=void 0===c?"":c,o=t.heading,i=void 0===o?"":o,u=t.photo,s=void 0===u?"":u,d=t.description,l=void 0===d?"":d,j=t.price,b=void 0===j?"":j,h=t.discount_percent,f=void 0===h?"":h,g=t.discount_end_date,O=void 0===g?"":g,_=a.a.createRef(),y={heading:!1,photo:!1,description:!1,price:!1,discount_percent:!1,discount_end_date:!1};return Object(D.jsxs)("div",{className:"edit-product__page",children:[Object(D.jsx)("button",{className:"edit-product__close_button",onClick:function(){return n("ProductsList")},children:"\u2716"}),Object(D.jsxs)("form",{className:"edit-product__container",onSubmit:function(e){e.preventDefault();var t={};y.heading&&(t.heading=e.target[0].value),y.photo&&(t.photo=e.target[1].files[0]),y.description&&(t.description=e.target[2].value),y.price&&(t.price=e.target[3].value),y.discount_percent&&(t.discount_percent=e.target[4].value),y.discount_end_date&&(t.discount_end_date=e.target[5].value),y.photo?(v(r),m(r,t.photo,(function(e){console.log(t),x(r,Object(p.a)(Object(p.a)({},t),{},{photo:e}))}))):x(r,t),n("ProductsList")},children:[Object(D.jsx)("p",{children:"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a"}),Object(D.jsx)("input",{name:"heading",defaultValue:i,type:"text",required:!0,minLength:"20",maxLength:"40",onChange:function(){return y.heading=!0}}),Object(D.jsx)("p",{children:"\u0424\u043e\u0442\u043e"}),Object(D.jsx)("a",{href:s,target:"_blank",rel:"noreferrer",children:"\u0424\u043e\u0442\u043e \u0441\u0435\u0439\u0447\u0430\u0441"}),Object(D.jsx)("input",{name:"photo",type:"file",alt:"image",accept:"image/*",onChange:function(e){var t=function(e){return e>=200&&e<=4e3},n=new FileReader;n.onload=function(){var c=new Image;c.onload=function(){t(c.width)&&t(c.height)?y.photo=!0:(alert("\u0428\u0438\u0440\u0438\u043d\u0430 \u0438 \u0432\u044b\u0441\u043e\u0442\u0430 \u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0434\u043e\u043b\u0436\u043d\u044b \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435 200 \u0438 \u043c\u0435\u043d\u044c\u0448\u0435 4000"),e.target.value="")},c.src=n.result},n.readAsDataURL(e.target.files[0])}}),Object(D.jsx)("p",{children:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435"}),Object(D.jsx)("textarea",{name:"description",defaultValue:l,type:"text",maxLength:"200",onChange:function(){return y.description=!0}}),Object(D.jsx)("p",{children:"\u0426\u0435\u043d\u0430"}),Object(D.jsx)("input",{name:"price",defaultValue:b,type:"number",required:!0,step:"0.01",min:"0",max:"99999999.99",onChange:function(){return y.price=!0}}),Object(D.jsx)("p",{children:"\u0421\u043a\u0438\u0434\u043a\u0430"}),Object(D.jsx)("input",{name:"discount-percent",defaultValue:f,type:"number",min:"10",max:"90",onChange:function(e){""!==e.target.value!==_.current.required&&(_.current.required=""!==e.target.value),y.discount_percent=!0}}),Object(D.jsx)("p",{children:"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0441\u043a\u0438\u0434\u043a\u0438"}),Object(D.jsx)("input",{name:"discount-end-date",defaultValue:O,type:"date",min:function(){var e=new Date;e.setDate(e.getDate()+1);var t=function(e){return e<10?"0".concat(e):e};return"".concat(e.getFullYear(),"-").concat(t(e.getMonth()+1),"-").concat(t(e.getDate()))}(),ref:_,onChange:function(){return y.discount_end_date=!0}}),Object(D.jsx)("button",{children:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c"})]})]})}));n(55),n(56);var k={pageChanged:u,editProduct:function(e){return{type:"EDIT_PRODUCT",payload:e}}},L=Object(i.b)((function(e){return{user:e.user}}),k)((function(e){var t=e.product,n=e.user,c=e.pageChanged,a=e.editProduct,r=t.heading,o=void 0===r?"":r,i=t.photo,u=void 0===i?"":i,s=t.description,d=void 0===s?"":s,p=t.price,l=void 0===p?"":p,j=t.discount_percent,b=void 0===j?"":j,h=t.discount_end_date,f=void 0===h?"":h,g=t.user_id,O=void 0===g?"":g,m=Math.floor((new Date(f).getTime()-(new Date).getTime())/864e5),v=""!==b&&m>=0,x=function(e){return Math.floor(100*e)/100};return Object(D.jsxs)("div",{className:"products-list-item__container",children:[O===n.uid?Object(D.jsxs)("div",{className:"dropdown",children:[Object(D.jsx)("button",{className:"dropbtn",children:"\u2699"}),Object(D.jsxs)("div",{className:"dropdown-content",children:[Object(D.jsx)("button",{onClick:function(){a(t),c("EditProduct")},children:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"}),Object(D.jsx)("button",{onClick:function(){var e=u.match(/image\..+\?/)[0].split(".").pop();window.confirm("\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b \u0447\u0442\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442?")&&(!function(e,t){w.apply(this,arguments)}(t.id,e.substring(0,e.length-1)),c("ProductsList"))},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"})]})]}):"",Object(D.jsx)("div",{className:"products-list-item__photo-container",children:Object(D.jsx)("img",{className:"products-list-item__photo",src:u,alt:o})}),Object(D.jsx)("p",{className:"products-list-item__heading",children:o}),Object(D.jsx)("p",{className:"products-list-item__description",children:d}),Object(D.jsxs)("div",{className:"products-list-item__price-container",children:[Object(D.jsx)("p",{className:v?"products-list-item__line-through":"",children:"".concat(x(l),"$")}),v?Object(D.jsx)("p",{style:{paddingLeft:"10px"},children:"".concat(x(l*((100-b)/100)),"$ (\u041e\u0441\u0442\u0430\u043b\u043e\u0441\u044c \u0434\u043d\u0435\u0439: ").concat(m+1,")")}):""]})]})}));var A={productsUpdate:function(e){return{type:"PRODUCTS_UPDATE",payload:e}},pageChanged:u},T=Object(i.b)((function(e){return{products:e.products}}),A)((function(e){var t=e.products,n=e.productsUpdate,a=e.pageChanged;return function(e){O.apply(this,arguments)}(n),Object(c.useEffect)((function(){console.log("ProductsList")}),[]),Object(D.jsxs)("div",{className:"product-list__page",children:[Object(D.jsx)("button",{className:"product-list__button",onClick:function(){a("AddProduct")},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043f\u0440\u043e\u0434\u0443\u043a\u0442"}),Object(D.jsx)("div",{className:"product-list__container",children:t.map((function(e){return Object(D.jsx)(L,{product:e},e.id)}))})]})}));n(57);var R=Object(i.b)((function(e){return{page:e.page}}))((function(e){var t=e.page;return Object(D.jsx)("div",{className:"App",children:function(){switch(t){case"Authorization":return Object(D.jsx)(E,{});case"AddProduct":return Object(D.jsx)(P,{});case"EditProduct":return Object(D.jsx)(U,{});case"ProductsList":return Object(D.jsx)(T,{});default:return Object(D.jsx)("div",{})}}()})})),q=n(38),S={products:[],page:"Authorization",user:"",productInfo:{}},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:S,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PAGE_CHANGED":return Object(p.a)(Object(p.a)({},e),{},{page:t.payload});case"USER_UPDATE":return Object(p.a)(Object(p.a)({},e),{},{user:t.payload});case"PRODUCTS_UPDATE":return Object(p.a)(Object(p.a)({},e),{},{products:t.payload});case"EDIT_PRODUCT":return Object(p.a)(Object(p.a)({},e),{},{productInfo:t.payload});default:return e}},V=Object(q.a)(G);o.a.render(Object(D.jsx)(a.a.StrictMode,{children:Object(D.jsx)(i.a,{store:V,children:Object(D.jsx)(R,{})})}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.1ba4f20c.chunk.js.map